name: functions-test
shortName: functest
version: 0.1.0
ingredients:
  - "@azbake/ingredient-app-insights@~0"
  - "@azbake/ingredient-functions@~0"
resourceGroup: true
#rgOverride: "" 
variables:
  funcAppResourceGroup:  kn-bake-rg
  storageAccountConnectionString: DefaultEndpointsProtocol=https;AccountName=knbakestorageaccount;AccountKey=vbhcYmauSy6PIZ4yW4YnU8qR7ClpozYwXJMW+AA4OBMyUBLsyEi8VUJeY4l5QyGHzVFYBywDXGDG0JjlTBgThw==;EndpointSuffix=core.windows.net
  container_registry_url: https://index.docker.io
  container_registry_user: nikitkon
  container_registry_password: 
  hostingPlanName: kn-bake-app-service-plan
  hostingEnvironment: hello-docker-function-hosting-environment
recipe:
  functions:
    properties:
      type: "@azbake/ingredient-functions"
      source: ./arm.json
      parameters:
        funcAppName: "[functions.create_resource_name('hello-docker-function-1')]"
        funcAppResourceGroup: "[coreutils.variable('funcAppResourceGroup')]"
        storageAccountConnectionString: "[coreutils.variable('storageAccountConnectionString')]"
        container_registry_url: "[coreutils.variable('container_registry_url')]"
        container_registry_user: "[coreutils.variable('container_registry_user')]"
        container_registry_password: "[coreutils.variable('container_registry_password')]"
        container_image_name: nikitkon/hello-docker-function:v1.0.2
        hostingPlanName: "[coreutils.variable('hostingPlanName')]"
        location: East US
        hostingEnvironment: "[coreutils.variable('hostingEnvironment')]"
        appInsightsKey: "[appinsights.get_instrumentation_key('helloworld','appinsights')]"
